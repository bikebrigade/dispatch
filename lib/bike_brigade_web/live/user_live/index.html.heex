<%= if @live_action in [:new, :edit] do %>
  <UI.modal show id={:edit} return_to={~p"/users"}>
    <:title><%= Atom.to_string(@live_action) |> String.capitalize() %> Dispatcher</:title>
    <.live_component
      module={BikeBrigadeWeb.UserLive.FormComponent}
      id={@user.id || :new}
      action={@live_action}
      user={@user}
      return_to={~p"/users"}
    />
  </UI.modal>
<% end %>
<UI.table rows={@users}>
  <:th>
    Name
  </:th>
  <:th>
    Phone
  </:th>
  <:th class="text-right">
    Status
  </:th>
  <:th class="flex justify-end" padding="px-3 py-3" uppercase={false}>
    <.button patch={~p"/users/new"}>
      New
    </.button>
  </:th>
  <:td :let={user}>
    <div class="flex items-center">
      <div class="flex-shrink-0 w-10 h-10">
        <img class="w-10 h-10 rounded-full" src={gravatar(user.email)} alt="" />
      </div>
      <div class="ml-4 ">
        <div class="text-sm font-medium leading-5 text-gray-900"><%= user.name %></div>
        <div class="text-sm leading-5 text-gray-500"><%= user.email %></div>
      </div>
    </div>
  </:td>
  <:td :let={user}>
    <%= user.phone %>
  </:td>
  <:td :let={user} class="text-right">
    <%= if user.is_dispatcher do %>
      <.with_tooltip>
        🧑‍🔧
        <:tooltip>Dispatcher</:tooltip>
      </.with_tooltip>
    <% end %>
    <%= if user.rider_id  do %>
      <.with_tooltip>
        🚴
        <:tooltip>Rider</:tooltip>
      </.with_tooltip>
    <% end %>
  </:td>
  <:td :let={user} class="text-right">
    <.link patch={~p"/users/#{user}/edit"} class="pl-2 link">
      Edit
    </.link>
    <.link
      phx-click={JS.push("delete", value: %{id: user.id})}
      data-confirm="Are you sure?"
      class="pl-2 link"
    >
      Delete
    </.link>
  </:td>
</UI.table>
